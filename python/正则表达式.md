---
title: 正则表达式
tags: 正则表达式,re
---
# Python 正则表达式 re 模块的使用
## 匹配  后者相反
```
    \d \D   匹配数字
    \s \S   匹配任意的空白符[ \t\n\r\f\v]
    \w \W   匹配字母或数字或下划线或汉字
    \b \B   匹配单词的开始
    ^   $   匹配字符串的开始
    \A \Z   匹配开头
    .匹配除换行符以外的任意字符
    *+?{m, n} 分别匹配0 - ;1 - ;0 - 1 ;m - n;
    [^ a]   非a
    []      #字符集
```
## 其他
```
    '\\'  转义
    ()分组
    r 转义
    ?非贪婪
```
## re各种方法
```
    re.findall('(?#)abc', 'A\nBc')
    pat = re.compile('(^w+).python.org')  # 编译
    re.search(pat, text)  # 搜索
    re.match('(?P<shuzi>a.c)', 'abc').group('shuzi')  # 从开头匹配
    re.findall(pat, text)  # list
    group() groups() group(1)
    text = 'a, b,,,,c  d'
    re.split('[, ]+', text, maxsplit=2)  # MAX=2
    re.sub('a', 'b', 'abca', count=1)    # 一次
    log = '2016-12-01'
    re.sub('(?P<year>\d{4})-(?P<month>\d{2})-(?P<day>\d{2})',
           r'\g<day>/\g<month>/\g<year>', log)
    pattern = '(?P<year>\d{4})-(?P<month>\d{2})-(?P<day>\d{2})'
    m = re.search(pattern, '2016-01-01')
    m.groupdict()
    m.group('year')
    m.group('month')
    m.group('day')
```
## 捕获&模式
### 捕获
    捕获(exp)                匹配exp, 并捕获文本到自动命名的组里
    (?< name > exp)          匹配exp, 并捕获文本到名称为name的组里，也可以写成(?'name'exp)
    (?: exp)                 匹配exp, 不捕获匹配的文本，也不给此分组分配组号
    零宽断言(?=exp)          匹配exp前面的位置
    (?<= exp)                匹配exp后面的位置
    (?!exp)                  匹配后面跟的不是exp的位置
    (?<!exp)                 匹配前面不是exp的位置
    (?  # ...)               注释，不影响正则表达式其它部分,用法参见 模式 I
    (?(id / name)yes | no)   若前面指定id或name的分区匹配成功则执行yes处的正则，否则执行no处的正则
    (?P=name)                分组的引用模式，可在同一个正则表达式用引用前面命名过的正则

### flags 编译时指定的模式
    re.compile('', re.I | re.M | re.S)
    regex=re.compile("hello world!", re.I)MSXU
    IgnoreCase(忽略大小写)        匹配时不区分大小写。
    Multiline(多行模式)           更改 ^ 和$的含义，使它们分别在任意一行的行首和行尾匹配，而不仅仅在整个字符串的开头和结尾匹配。
    Singleline(单行模式)          更改.的含义，使它与每一个字符匹配（包括换行符'\n')
    IgnorePatternWhitespace(忽略空白)   忽略表达式中的非转义空白并启用由  # 标记的注释。
    ExplicitCapture(显式捕获)     仅捕获已被显式命名的组。
    X VERBOSE，                   此模式忽略正则表达式中的空白和  # 号的注释
## 例子
    mail
    pattern = r"(^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$)"
    http
    pattern = '^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$'
    ip4
    pattern = r'^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
    ip6
    pattern = r'^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$'
    mac
    pattern = r'^(?i)([0-9A-F]{2}[:-]){5}([0-9A-F]{2})$'
    1.校验密码强度
        密码的强度必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8 - 10之间
        '^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$'
    2.校验中文
        字符串只能是中文
        '^[\\u4e00-\\u9fa5]{0,}$'
    3.校验身份证号码
        15位：
        '^[1-9]\\d{7}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}$'
        18位：
        '^[1-9]\\d{5}[1-9]\\d{3}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}([0-9]|X)$'
    4.校验手机号
        下面是国内 1358开头的手机号正则表达式
        '^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d{8}$'判断IE的版本
        '^.*MSIE [5-8](?:\\.[0-9]+)?(?!.*Trident\\/[5-9]\\.0).*$'
    5.提取URL链接
        '^(f|ht){1}(tp|tps):\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?'
    6.文件路径及扩展名校验
        '^([a-zA-Z]\\:|\\\\)\\\\([^\\\\]+\\\\)*[^\\/:*?"<>|]+\\.txt(l)?$'
    7.查找CSS属性
        '^\\s*[a-zA-Z\\-]+\\s*[:]{1}\\s[a-zA-Z0-9\\s.#]+[;]{1}'
    8.抽取注释
        '<!--(.*?)-->'
    9.匹配HTML标签
        '<\\/?\\w+((\\s+\\w+(\\s*=\\s*(?:".*?"|'.*?'|[\\^'">\\s] + ))?) +\\s*|\\s*)\\/?>'

## 匹配例子
```
1、非负整数：^\d+$ 
2、正整数：^[0-9]*[1-9][0-9]*$ 
3、非正整数：^((-\d+)|(0+))$ 
4、负整数：^-[0-9]*[1-9][0-9]*$ 
5、整数：^-?\d+$ 
6、非负浮点数：^\d+(\.\d+)?$ 
7、正浮点数：^((0-9)+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$ 
8、非正浮点数：^((-\d+\.\d+)?)|(0+(\.0+)?))$ 
9、负浮点数：^(-((正浮点数正则式)))$ 
10、英文字符串：^[A-Za-z]+$ 
11、英文大写串：^[A-Z]+$ 
12、英文小写串：^[a-z]+$ 
13、英文字符数字串：^[A-Za-z0-9]+$ 
14、英数字加下划线串：^\w+$ 
15、E-mail地址：^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$ 
16、URL：^[a-zA-Z]+://(\w+(-\w+)*)(\.(\w+(-\w+)*))*(\?\s*)?$ 
或：^http:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^\"\"])*$ 
17、邮政编码：^[1-9]\d{5}$ 
18、中文：^[\u0391-\uFFE5]+$ 
19、电话号码：^((\(\d{2,3}\))|(\d{3}\-))?(\(0\d{2,3}\)|0\d{2,3}-)?[1-9]\d{6,7}(\-\d{1,4})?$ 
20、手机号码：^((\(\d{2,3}\))|(\d{3}\-))?13\d{9}$ 
21、双字节字符(包括汉字在内)：^\x00-\xff 
22、匹配首尾空格：(^\s*)|(\s*$)（像vbscript那样的trim函数） 
23、匹配HTML标记：.*| 
24、匹配空行：\n[\s| ]*\r 
25、提取信息中的网络链接：(h|H)(r|R)(e|E)(f|F) *= *('|")?(\w|\\|\/|\.)+('|"| *|>)? 
26、提取信息中的邮件地址：\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)* 
27、提取信息中的图片链接：(s|S)(r|R)(c|C) *= *('|")?(\w|\\|\/|\.)+('|"| *|>)? 
28、提取信息中的IP地址：(\d+)\.(\d+)\.(\d+)\.(\d+) 
29、提取信息中的中国手机号码：(86)*0*13\d{9} 
30、提取信息中的中国固定电话号码：(\(\d{3,4}\)|\d{3,4}-|\s)?\d{8} 
31、提取信息中的中国电话号码（包括移动和固定电话）：(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14} 
32、提取信息中的中国邮政编码：[1-9]{1}(\d+){5} 
33、提取信息中的浮点数（即小数）：(-?\d*)\.?\d+ 
34、提取信息中的任何数字 ：(-?\d*)(\.\d+)? 
35、IP：(\d+)\.(\d+)\.(\d+)\.(\d+) 
36、电话区号：/^0\d{2,3}$/ 
37、腾讯QQ号：^[1-9]*[1-9][0-9]*$ 
38、帐号(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]{4,15}$ 
39、中文、英文、数字及下划线：^[\u4e00-\u9fa5_a-zA-Z0-9]+$



只能输入数字：“^[0-9]*$”
只能输入n位的数字：“^d{n}$”
只能输入至少n位数字：“^d{n,}$”
只能输入m-n位的数字：“^d{m,n}$”
只能输入零和非零开头的数字：“^(0|[1-9][0-9]*)$”
只能输入有两位小数的正实数：“^[0-9]+(.[0-9]{2})?$”
只能输入有1-3位小数的正实数：“^[0-9]+(.[0-9]{1,3})?$”
只能输入非零的正整数：“^+?[1-9][0-9]*$”
只能输入非零的负整数：“^-[1-9][0-9]*$”
只能输入长度为3的字符：“^.{3}$”
只能输入由26个英文字母组成的字符串：“^[A-Za-z]+$”
只能输入由26个大写英文字母组成的字符串：“^[A-Z]+$”
只能输入由26个小写英文字母组成的字符串：“^[a-z]+$”
只能输入由数字和26个英文字母组成的字符串：“^[A-Za-z0-9]+$”
只能输入由数字、26个英文字母或者下划线组成的字符串：“^w+$”
验证用户密码:“^[a-zA-Z]w{5,17}$”正确格式为：以字母开头，长度在6-18之间，

只能包含字符、数字和下划线。
验证是否含有^%&’,;=?$”等字符：“[^%&',;=?$x22]+”
只能输入汉字：“^[u4e00-u9fa5],{0,}$”
验证Email地址：“^w+[-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*$”
验证InternetURL：“^http://([w-]+.)+[w-]+(/[w-./?%&=]*)?$”
验证电话号码：“^((d{3,4})|d{3,4}-)?d{7,8}$”

正确格式为：“XXXX-XXXXXXX”，“XXXX-XXXXXXXX”，“XXX-XXXXXXX”，

“XXX-XXXXXXXX”，“XXXXXXX”，“XXXXXXXX”。
验证身份证号（15位或18位数字）：“^d{15}|d{}18$”
验证一年的12个月：“^(0?[1-9]|1[0-2])$”正确格式为：“01”-“09”和“1”“12”
验证一个月的31天：“^((0?[1-9])|((1|2)[0-9])|30|31)$”
```